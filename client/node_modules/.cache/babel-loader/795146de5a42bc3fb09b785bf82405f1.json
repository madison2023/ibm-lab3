{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport { useEffect, useCallback, useRef, useReducer, useMemo } from 'react';\nimport useSSR from 'use-ssr';\nimport useRefState from 'urs';\nimport { HTTPMethod, CachePolicies } from './types';\nimport useFetchArgs from './useFetchArgs';\nimport doFetchArgs from './doFetchArgs';\nimport { invariant, tryGetData, toResponseObject, useDeepCallback, isFunction, sleep, makeError } from './utils';\nimport useCache from './useCache';\nvar CACHE_FIRST = CachePolicies.CACHE_FIRST;\n\nfunction useFetch() {\n  var _this = this;\n\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  var _a = useFetchArgs.apply(void 0, args),\n      host = _a.host,\n      path = _a.path,\n      customOptions = _a.customOptions,\n      requestInit = _a.requestInit,\n      dependencies = _a.dependencies;\n\n  var cacheLife = customOptions.cacheLife,\n      cachePolicy = customOptions.cachePolicy,\n      // 'cache-first' by default\n  interceptors = customOptions.interceptors,\n      onAbort = customOptions.onAbort,\n      onError = customOptions.onError,\n      onNewData = customOptions.onNewData,\n      onTimeout = customOptions.onTimeout,\n      perPage = customOptions.perPage,\n      persist = customOptions.persist,\n      responseType = customOptions.responseType,\n      retries = customOptions.retries,\n      retryDelay = customOptions.retryDelay,\n      retryOn = customOptions.retryOn,\n      suspense = customOptions.suspense,\n      timeout = customOptions.timeout,\n      defaults = __rest(customOptions, [\"cacheLife\", \"cachePolicy\", \"interceptors\", \"onAbort\", \"onError\", \"onNewData\", \"onTimeout\", \"perPage\", \"persist\", \"responseType\", \"retries\", \"retryDelay\", \"retryOn\", \"suspense\", \"timeout\"]);\n\n  var cache = useCache({\n    persist: persist,\n    cacheLife: cacheLife,\n    cachePolicy: cachePolicy\n  });\n  var isServer = useSSR().isServer;\n  var controller = useRef();\n  var res = useRef({});\n  var data = useRef(defaults.data);\n  var timedout = useRef(false);\n  var attempt = useRef(0);\n  var error = useRef();\n  var hasMore = useRef(true);\n  var suspenseStatus = useRef('pending');\n  var suspender = useRef();\n  var mounted = useRef(false);\n\n  var _b = useRefState(defaults.loading),\n      loading = _b[0],\n      setLoading = _b[1];\n\n  var forceUpdate = useReducer(function () {\n    return {};\n  }, [])[1];\n  var makeFetch = useDeepCallback(function (method) {\n    var doFetch = function (routeOrBody, body) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var theController, _a, url, options, response, timer, newData, newRes, _b, _c, opts, shouldRetry, _d, _e, theData, err_1, opts, shouldRetry, _f, _g, theData;\n\n        return __generator(this, function (_h) {\n          switch (_h.label) {\n            case 0:\n              if (isServer) return [2\n              /*return*/\n              ]; // for now, we don't do anything on the server\n\n              controller.current = new AbortController();\n              controller.current.signal.onabort = onAbort;\n              theController = controller.current;\n              return [4\n              /*yield*/\n              , doFetchArgs(requestInit, method, theController, cacheLife, cache, host, path, routeOrBody, body, interceptors.request)];\n\n            case 1:\n              _a = _h.sent(), url = _a.url, options = _a.options, response = _a.response;\n              error.current = undefined; // don't perform the request if there is no more data to fetch (pagination)\n\n              if (perPage > 0 && !hasMore.current && !error.current) return [2\n              /*return*/\n              , data.current];\n              if (!suspense) setLoading(true);\n              timer = timeout && setTimeout(function () {\n                timedout.current = true;\n                theController.abort();\n                if (onTimeout) onTimeout();\n              }, timeout);\n              _h.label = 2;\n\n            case 2:\n              _h.trys.push([2, 17, 23, 24]);\n\n              if (!(response.isCached && cachePolicy === CACHE_FIRST)) return [3\n              /*break*/\n              , 3];\n              newRes = response.cached;\n              return [3\n              /*break*/\n              , 5];\n\n            case 3:\n              return [4\n              /*yield*/\n              , fetch(url, options)];\n\n            case 4:\n              newRes = _h.sent().clone();\n              _h.label = 5;\n\n            case 5:\n              res.current = newRes.clone();\n              return [4\n              /*yield*/\n              , tryGetData(newRes, defaults.data, responseType)];\n\n            case 6:\n              newData = _h.sent();\n              res.current.data = onNewData(data.current, newData);\n              _b = res;\n              if (!interceptors.response) return [3\n              /*break*/\n              , 8];\n              return [4\n              /*yield*/\n              , interceptors.response({\n                response: res.current\n              })];\n\n            case 7:\n              _c = _h.sent();\n              return [3\n              /*break*/\n              , 9];\n\n            case 8:\n              _c = res.current;\n              _h.label = 9;\n\n            case 9:\n              _b.current = _c;\n              invariant('data' in res.current, 'You must have `data` field on the Response returned from your `interceptors.response`');\n              data.current = res.current.data;\n              opts = {\n                attempt: attempt.current,\n                response: newRes\n              }; // if we just have `retries` set with NO `retryOn` then\n              // automatically retry on fail until attempts run out\n\n              _d = !isFunction(retryOn) && Array.isArray(retryOn) && retryOn.length < 1 && (newRes === null || newRes === void 0 ? void 0 : newRes.ok) === false // otherwise only retry when is specified\n              || Array.isArray(retryOn) && retryOn.includes(newRes.status);\n              if (_d) // if we just have `retries` set with NO `retryOn` then\n                // automatically retry on fail until attempts run out\n                return [3\n                /*break*/\n                , 12];\n              _e = isFunction(retryOn);\n              if (!_e) return [3\n              /*break*/\n              , 11];\n              return [4\n              /*yield*/\n              , retryOn(opts)];\n\n            case 10:\n              _e = _h.sent();\n              _h.label = 11;\n\n            case 11:\n              _d = _e;\n              _h.label = 12;\n\n            case 12:\n              shouldRetry = _d && retries > 0 && retries > attempt.current;\n              if (!shouldRetry) return [3\n              /*break*/\n              , 14];\n              return [4\n              /*yield*/\n              , retry(opts, routeOrBody, body)];\n\n            case 13:\n              theData = _h.sent();\n              return [2\n              /*return*/\n              , theData];\n\n            case 14:\n              if (!(cachePolicy === CACHE_FIRST && !response.isCached)) return [3\n              /*break*/\n              , 16];\n              return [4\n              /*yield*/\n              , cache.set(response.id, newRes.clone())];\n\n            case 15:\n              _h.sent();\n\n              _h.label = 16;\n\n            case 16:\n              if (Array.isArray(data.current) && !!(data.current.length % perPage)) hasMore.current = false;\n              return [3\n              /*break*/\n              , 24];\n\n            case 17:\n              err_1 = _h.sent();\n              if (attempt.current >= retries && timedout.current) error.current = makeError('AbortError', 'Timeout Error');\n              opts = {\n                attempt: attempt.current,\n                error: err_1\n              }; // if we just have `retries` set with NO `retryOn` then\n              // automatically retry on fail until attempts run out\n\n              _f = !isFunction(retryOn) && Array.isArray(retryOn) && retryOn.length < 1;\n              if (_f) // if we just have `retries` set with NO `retryOn` then\n                // automatically retry on fail until attempts run out\n                return [3\n                /*break*/\n                , 20];\n              _g = isFunction(retryOn);\n              if (!_g) return [3\n              /*break*/\n              , 19];\n              return [4\n              /*yield*/\n              , retryOn(opts)];\n\n            case 18:\n              _g = _h.sent();\n              _h.label = 19;\n\n            case 19:\n              _f = _g;\n              _h.label = 20;\n\n            case 20:\n              shouldRetry = _f && retries > 0 && retries > attempt.current;\n              if (!shouldRetry) return [3\n              /*break*/\n              , 22];\n              return [4\n              /*yield*/\n              , retry(opts, routeOrBody, body)];\n\n            case 21:\n              theData = _h.sent();\n              return [2\n              /*return*/\n              , theData];\n\n            case 22:\n              if (err_1.name !== 'AbortError') {\n                error.current = err_1;\n              }\n\n              return [3\n              /*break*/\n              , 24];\n\n            case 23:\n              timedout.current = false;\n              if (timer) clearTimeout(timer);\n              controller.current = undefined;\n              return [7\n              /*endfinally*/\n              ];\n\n            case 24:\n              if (newRes && !newRes.ok && !error.current) error.current = makeError(newRes.status, newRes.statusText);\n              if (!suspense) setLoading(false);\n              if (attempt.current === retries) attempt.current = 0;\n              if (error.current) onError({\n                error: error.current\n              });\n              return [2\n              /*return*/\n              , data.current];\n          }\n        });\n      });\n    }; // end of doFetch()\n\n\n    var retry = function (opts, routeOrBody, body) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var delay, d;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              delay = isFunction(retryDelay) ? retryDelay(opts) : retryDelay;\n\n              if (!(Number.isInteger(delay) && delay >= 0)) {\n                console.error('retryDelay must be a number >= 0! If you\\'re using it as a function, it must also return a number >= 0.');\n              }\n\n              attempt.current++;\n              if (!delay) return [3\n              /*break*/\n              , 2];\n              return [4\n              /*yield*/\n              , sleep(delay)];\n\n            case 1:\n              _a.sent();\n\n              _a.label = 2;\n\n            case 2:\n              return [4\n              /*yield*/\n              , doFetch(routeOrBody, body)];\n\n            case 3:\n              d = _a.sent();\n              return [2\n              /*return*/\n              , d];\n          }\n        });\n      });\n    };\n\n    if (suspense) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return __awaiter(_this, void 0, void 0, function () {\n          var newData;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                suspender.current = doFetch.apply(void 0, args).then(function (newData) {\n                  suspenseStatus.current = 'success';\n                  return newData;\n                }, function () {\n                  suspenseStatus.current = 'error';\n                });\n                forceUpdate();\n                return [4\n                /*yield*/\n                , suspender.current];\n\n              case 1:\n                newData = _a.sent();\n                return [2\n                /*return*/\n                , newData];\n            }\n          });\n        });\n      };\n    }\n\n    return doFetch;\n  }, [isServer, onAbort, requestInit, host, path, interceptors, cachePolicy, perPage, timeout, persist, cacheLife, onTimeout, defaults.data, onNewData, forceUpdate, suspense]);\n  var post = useCallback(makeFetch(HTTPMethod.POST), [makeFetch]);\n  var del = useCallback(makeFetch(HTTPMethod.DELETE), [makeFetch]);\n  var request = useMemo(function () {\n    return Object.defineProperties({\n      get: makeFetch(HTTPMethod.GET),\n      post: post,\n      patch: makeFetch(HTTPMethod.PATCH),\n      put: makeFetch(HTTPMethod.PUT),\n      options: makeFetch(HTTPMethod.OPTIONS),\n      head: makeFetch(HTTPMethod.HEAD),\n      connect: makeFetch(HTTPMethod.CONNECT),\n      trace: makeFetch(HTTPMethod.TRACE),\n      del: del,\n      delete: del,\n      abort: function () {\n        return controller.current && controller.current.abort();\n      },\n      query: function (query, variables) {\n        return post({\n          query: query,\n          variables: variables\n        });\n      },\n      mutate: function (mutation, variables) {\n        return post({\n          mutation: mutation,\n          variables: variables\n        });\n      },\n      cache: cache\n    }, {\n      loading: {\n        get: function () {\n          return loading.current;\n        }\n      },\n      error: {\n        get: function () {\n          return error.current;\n        }\n      },\n      data: {\n        get: function () {\n          return data.current;\n        }\n      }\n    });\n  }, [makeFetch]);\n  var response = useMemo(function () {\n    return toResponseObject(res, data);\n  }, []); // onMount/onUpdate\n\n  useEffect(function () {\n    mounted.current = true;\n\n    if (Array.isArray(dependencies)) {\n      var methodName = requestInit.method || HTTPMethod.GET;\n      var methodLower = methodName.toLowerCase();\n      var req = request[methodLower];\n      req();\n    }\n\n    return function () {\n      return mounted.current = false;\n    };\n  }, dependencies); // Cancel any running request when unmounting to avoid updating state after component has unmounted\n  // This can happen if a request's promise resolves after component unmounts\n\n  useEffect(function () {\n    return request.abort;\n  }, []);\n\n  if (suspense && suspender.current) {\n    if (isServer) throw new Error('Suspense on server side is not yet supported! 🙅‍♂️');\n\n    switch (suspenseStatus.current) {\n      case 'pending':\n        throw suspender.current;\n\n      case 'error':\n        throw error.current;\n    }\n  }\n\n  return Object.assign([request, response, loading.current, error.current], __assign(__assign({\n    request: request,\n    response: response\n  }, request), {\n    loading: loading.current,\n    data: data.current,\n    error: error.current\n  }));\n}\n\nexport { useFetch };\nexport default useFetch;","map":{"version":3,"sources":["/Users/rachelmadison/lab-3-fixed-team-37/client/node_modules/use-http/dist/esm/useFetch.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","useEffect","useCallback","useRef","useReducer","useMemo","useSSR","useRefState","HTTPMethod","CachePolicies","useFetchArgs","doFetchArgs","invariant","tryGetData","toResponseObject","useDeepCallback","isFunction","sleep","makeError","useCache","CACHE_FIRST","useFetch","_this","args","_i","_a","host","path","customOptions","requestInit","dependencies","cacheLife","cachePolicy","interceptors","onAbort","onError","onNewData","onTimeout","perPage","persist","responseType","retries","retryDelay","retryOn","suspense","timeout","defaults","cache","isServer","controller","res","data","timedout","attempt","error","hasMore","suspenseStatus","suspender","mounted","_b","loading","setLoading","forceUpdate","makeFetch","method","doFetch","routeOrBody","theController","url","options","response","timer","newData","newRes","_c","opts","shouldRetry","_d","_e","theData","err_1","_f","_g","_h","current","AbortController","signal","onabort","request","undefined","setTimeout","abort","isCached","cached","fetch","clone","Array","isArray","ok","includes","status","retry","set","id","name","clearTimeout","statusText","delay","d","Number","isInteger","console","post","POST","del","DELETE","defineProperties","get","GET","patch","PATCH","put","PUT","OPTIONS","head","HEAD","connect","CONNECT","trace","TRACE","delete","query","variables","mutate","mutation","methodName","methodLower","toLowerCase","req","Error"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { useEffect, useCallback, useRef, useReducer, useMemo } from 'react';\nimport useSSR from 'use-ssr';\nimport useRefState from 'urs';\nimport { HTTPMethod, CachePolicies } from './types';\nimport useFetchArgs from './useFetchArgs';\nimport doFetchArgs from './doFetchArgs';\nimport { invariant, tryGetData, toResponseObject, useDeepCallback, isFunction, sleep, makeError } from './utils';\nimport useCache from './useCache';\nvar CACHE_FIRST = CachePolicies.CACHE_FIRST;\nfunction useFetch() {\n    var _this = this;\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var _a = useFetchArgs.apply(void 0, args), host = _a.host, path = _a.path, customOptions = _a.customOptions, requestInit = _a.requestInit, dependencies = _a.dependencies;\n    var cacheLife = customOptions.cacheLife, cachePolicy = customOptions.cachePolicy, // 'cache-first' by default\n    interceptors = customOptions.interceptors, onAbort = customOptions.onAbort, onError = customOptions.onError, onNewData = customOptions.onNewData, onTimeout = customOptions.onTimeout, perPage = customOptions.perPage, persist = customOptions.persist, responseType = customOptions.responseType, retries = customOptions.retries, retryDelay = customOptions.retryDelay, retryOn = customOptions.retryOn, suspense = customOptions.suspense, timeout = customOptions.timeout, defaults = __rest(customOptions, [\"cacheLife\", \"cachePolicy\", \"interceptors\", \"onAbort\", \"onError\", \"onNewData\", \"onTimeout\", \"perPage\", \"persist\", \"responseType\", \"retries\", \"retryDelay\", \"retryOn\", \"suspense\", \"timeout\"]);\n    var cache = useCache({ persist: persist, cacheLife: cacheLife, cachePolicy: cachePolicy });\n    var isServer = useSSR().isServer;\n    var controller = useRef();\n    var res = useRef({});\n    var data = useRef(defaults.data);\n    var timedout = useRef(false);\n    var attempt = useRef(0);\n    var error = useRef();\n    var hasMore = useRef(true);\n    var suspenseStatus = useRef('pending');\n    var suspender = useRef();\n    var mounted = useRef(false);\n    var _b = useRefState(defaults.loading), loading = _b[0], setLoading = _b[1];\n    var forceUpdate = useReducer(function () { return ({}); }, [])[1];\n    var makeFetch = useDeepCallback(function (method) {\n        var doFetch = function (routeOrBody, body) { return __awaiter(_this, void 0, void 0, function () {\n            var theController, _a, url, options, response, timer, newData, newRes, _b, _c, opts, shouldRetry, _d, _e, theData, err_1, opts, shouldRetry, _f, _g, theData;\n            return __generator(this, function (_h) {\n                switch (_h.label) {\n                    case 0:\n                        if (isServer)\n                            return [2 /*return*/]; // for now, we don't do anything on the server\n                        controller.current = new AbortController();\n                        controller.current.signal.onabort = onAbort;\n                        theController = controller.current;\n                        return [4 /*yield*/, doFetchArgs(requestInit, method, theController, cacheLife, cache, host, path, routeOrBody, body, interceptors.request)];\n                    case 1:\n                        _a = _h.sent(), url = _a.url, options = _a.options, response = _a.response;\n                        error.current = undefined;\n                        // don't perform the request if there is no more data to fetch (pagination)\n                        if (perPage > 0 && !hasMore.current && !error.current)\n                            return [2 /*return*/, data.current];\n                        if (!suspense)\n                            setLoading(true);\n                        timer = timeout && setTimeout(function () {\n                            timedout.current = true;\n                            theController.abort();\n                            if (onTimeout)\n                                onTimeout();\n                        }, timeout);\n                        _h.label = 2;\n                    case 2:\n                        _h.trys.push([2, 17, 23, 24]);\n                        if (!(response.isCached && cachePolicy === CACHE_FIRST)) return [3 /*break*/, 3];\n                        newRes = response.cached;\n                        return [3 /*break*/, 5];\n                    case 3: return [4 /*yield*/, fetch(url, options)];\n                    case 4:\n                        newRes = (_h.sent()).clone();\n                        _h.label = 5;\n                    case 5:\n                        res.current = newRes.clone();\n                        return [4 /*yield*/, tryGetData(newRes, defaults.data, responseType)];\n                    case 6:\n                        newData = _h.sent();\n                        res.current.data = onNewData(data.current, newData);\n                        _b = res;\n                        if (!interceptors.response) return [3 /*break*/, 8];\n                        return [4 /*yield*/, interceptors.response({ response: res.current })];\n                    case 7:\n                        _c = _h.sent();\n                        return [3 /*break*/, 9];\n                    case 8:\n                        _c = res.current;\n                        _h.label = 9;\n                    case 9:\n                        _b.current = _c;\n                        invariant('data' in res.current, 'You must have `data` field on the Response returned from your `interceptors.response`');\n                        data.current = res.current.data;\n                        opts = { attempt: attempt.current, response: newRes };\n                        // if we just have `retries` set with NO `retryOn` then\n                        // automatically retry on fail until attempts run out\n                        _d = !isFunction(retryOn) && Array.isArray(retryOn) && retryOn.length < 1 && (newRes === null || newRes === void 0 ? void 0 : newRes.ok) === false\n                            // otherwise only retry when is specified\n                            || Array.isArray(retryOn) && retryOn.includes(newRes.status);\n                        if (_d) \n                        // if we just have `retries` set with NO `retryOn` then\n                        // automatically retry on fail until attempts run out\n                        return [3 /*break*/, 12];\n                        _e = isFunction(retryOn);\n                        if (!_e) return [3 /*break*/, 11];\n                        return [4 /*yield*/, retryOn(opts)];\n                    case 10:\n                        _e = (_h.sent());\n                        _h.label = 11;\n                    case 11:\n                        _d = _e;\n                        _h.label = 12;\n                    case 12:\n                        shouldRetry = (_d) && retries > 0 && retries > attempt.current;\n                        if (!shouldRetry) return [3 /*break*/, 14];\n                        return [4 /*yield*/, retry(opts, routeOrBody, body)];\n                    case 13:\n                        theData = _h.sent();\n                        return [2 /*return*/, theData];\n                    case 14:\n                        if (!(cachePolicy === CACHE_FIRST && !response.isCached)) return [3 /*break*/, 16];\n                        return [4 /*yield*/, cache.set(response.id, newRes.clone())];\n                    case 15:\n                        _h.sent();\n                        _h.label = 16;\n                    case 16:\n                        if (Array.isArray(data.current) && !!(data.current.length % perPage))\n                            hasMore.current = false;\n                        return [3 /*break*/, 24];\n                    case 17:\n                        err_1 = _h.sent();\n                        if (attempt.current >= retries && timedout.current)\n                            error.current = makeError('AbortError', 'Timeout Error');\n                        opts = { attempt: attempt.current, error: err_1 };\n                        // if we just have `retries` set with NO `retryOn` then\n                        // automatically retry on fail until attempts run out\n                        _f = !isFunction(retryOn) && Array.isArray(retryOn) && retryOn.length < 1;\n                        if (_f) \n                        // if we just have `retries` set with NO `retryOn` then\n                        // automatically retry on fail until attempts run out\n                        return [3 /*break*/, 20];\n                        _g = isFunction(retryOn);\n                        if (!_g) return [3 /*break*/, 19];\n                        return [4 /*yield*/, retryOn(opts)];\n                    case 18:\n                        _g = (_h.sent());\n                        _h.label = 19;\n                    case 19:\n                        _f = _g;\n                        _h.label = 20;\n                    case 20:\n                        shouldRetry = (_f) && retries > 0 && retries > attempt.current;\n                        if (!shouldRetry) return [3 /*break*/, 22];\n                        return [4 /*yield*/, retry(opts, routeOrBody, body)];\n                    case 21:\n                        theData = _h.sent();\n                        return [2 /*return*/, theData];\n                    case 22:\n                        if (err_1.name !== 'AbortError') {\n                            error.current = err_1;\n                        }\n                        return [3 /*break*/, 24];\n                    case 23:\n                        timedout.current = false;\n                        if (timer)\n                            clearTimeout(timer);\n                        controller.current = undefined;\n                        return [7 /*endfinally*/];\n                    case 24:\n                        if (newRes && !newRes.ok && !error.current)\n                            error.current = makeError(newRes.status, newRes.statusText);\n                        if (!suspense)\n                            setLoading(false);\n                        if (attempt.current === retries)\n                            attempt.current = 0;\n                        if (error.current)\n                            onError({ error: error.current });\n                        return [2 /*return*/, data.current];\n                }\n            });\n        }); }; // end of doFetch()\n        var retry = function (opts, routeOrBody, body) { return __awaiter(_this, void 0, void 0, function () {\n            var delay, d;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        delay = (isFunction(retryDelay) ? retryDelay(opts) : retryDelay);\n                        if (!(Number.isInteger(delay) && delay >= 0)) {\n                            console.error('retryDelay must be a number >= 0! If you\\'re using it as a function, it must also return a number >= 0.');\n                        }\n                        attempt.current++;\n                        if (!delay) return [3 /*break*/, 2];\n                        return [4 /*yield*/, sleep(delay)];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2: return [4 /*yield*/, doFetch(routeOrBody, body)];\n                    case 3:\n                        d = _a.sent();\n                        return [2 /*return*/, d];\n                }\n            });\n        }); };\n        if (suspense) {\n            return function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                return __awaiter(_this, void 0, void 0, function () {\n                    var newData;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                suspender.current = doFetch.apply(void 0, args).then(function (newData) {\n                                    suspenseStatus.current = 'success';\n                                    return newData;\n                                }, function () {\n                                    suspenseStatus.current = 'error';\n                                });\n                                forceUpdate();\n                                return [4 /*yield*/, suspender.current];\n                            case 1:\n                                newData = _a.sent();\n                                return [2 /*return*/, newData];\n                        }\n                    });\n                });\n            };\n        }\n        return doFetch;\n    }, [isServer, onAbort, requestInit, host, path, interceptors, cachePolicy, perPage, timeout, persist, cacheLife, onTimeout, defaults.data, onNewData, forceUpdate, suspense]);\n    var post = useCallback(makeFetch(HTTPMethod.POST), [makeFetch]);\n    var del = useCallback(makeFetch(HTTPMethod.DELETE), [makeFetch]);\n    var request = useMemo(function () { return Object.defineProperties({\n        get: makeFetch(HTTPMethod.GET),\n        post: post,\n        patch: makeFetch(HTTPMethod.PATCH),\n        put: makeFetch(HTTPMethod.PUT),\n        options: makeFetch(HTTPMethod.OPTIONS),\n        head: makeFetch(HTTPMethod.HEAD),\n        connect: makeFetch(HTTPMethod.CONNECT),\n        trace: makeFetch(HTTPMethod.TRACE),\n        del: del,\n        delete: del,\n        abort: function () { return controller.current && controller.current.abort(); },\n        query: function (query, variables) { return post({ query: query, variables: variables }); },\n        mutate: function (mutation, variables) { return post({ mutation: mutation, variables: variables }); },\n        cache: cache\n    }, {\n        loading: { get: function () { return loading.current; } },\n        error: { get: function () { return error.current; } },\n        data: { get: function () { return data.current; } },\n    }); }, [makeFetch]);\n    var response = useMemo(function () { return toResponseObject(res, data); }, []);\n    // onMount/onUpdate\n    useEffect(function () {\n        mounted.current = true;\n        if (Array.isArray(dependencies)) {\n            var methodName = requestInit.method || HTTPMethod.GET;\n            var methodLower = methodName.toLowerCase();\n            var req = request[methodLower];\n            req();\n        }\n        return function () { return mounted.current = false; };\n    }, dependencies);\n    // Cancel any running request when unmounting to avoid updating state after component has unmounted\n    // This can happen if a request's promise resolves after component unmounts\n    useEffect(function () { return request.abort; }, []);\n    if (suspense && suspender.current) {\n        if (isServer)\n            throw new Error('Suspense on server side is not yet supported! 🙅‍♂️');\n        switch (suspenseStatus.current) {\n            case 'pending':\n                throw suspender.current;\n            case 'error':\n                throw error.current;\n        }\n    }\n    return Object.assign([request, response, loading.current, error.current], __assign(__assign({ request: request, response: response }, request), { loading: loading.current, data: data.current, error: error.current }));\n}\nexport { useFetch };\nexport default useFetch;\n"]},"metadata":{},"sourceType":"module"}